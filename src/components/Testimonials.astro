---
import Translate from './Translate.astro';
import { getLocaleFromPath, getTranslation } from '../i18n/utils';

const locale = getLocaleFromPath(Astro.url.pathname);
const testimonials = getTranslation(locale, 'testimonials.items');
---

<section class="py-12 sm:py-16 md:py-20" id="testimonios">
  <div class="container">
    <div class="text-center mb-12 sm:mb-16 px-4">
      <h2 class="text-2xl sm:text-3xl font-bold mb-3 sm:mb-4"><Translate key="testimonials.title" /></h2>
      <p class="text-text-muted text-sm sm:text-base"><Translate key="testimonials.description" /></p>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8">
      {Array.isArray(testimonials) && testimonials.map(testimonial => (
        <div class="card testimonial-card">
          <svg class="quote-icon" width="45" height="36" viewBox="0 0 45 36" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M13.4 36L0 24.6V0H19.8V24.6H6.4L19.8 36H13.4ZM38.6 36L25.2 24.6V0H45V24.6H31.6L45 36H38.6Z" fill="currentColor"/>
          </svg>

          <blockquote class="mt-6 mb-8">
            <p class="text-lg">{testimonial.content}</p>
          </blockquote>

          <footer class="flex items-center gap-4">
            <div class="w-12 h-12 rounded-full bg-secondary flex items-center justify-center">
              <span class="text-xl font-bold">{testimonial.name[0]}</span>
            </div>
            <div>
              <cite class="not-italic font-semibold">{testimonial.name}</cite>
              <p class="text-text-muted text-sm">{testimonial.role}</p>
              {testimonial.company && <p class="text-text-muted text-xs">{testimonial.company}</p>}
            </div>
          </footer>
        </div>
      ))}
    </div>
  </div>
</section>

<style>
  .testimonial-card {
    position: relative;
  }

  .quote-icon {
    color: var(--color-accent);
    opacity: 0.2;
  }

  .text-text-muted {
    color: var(--color-text-muted);
  }

  blockquote p {
    position: relative;
    color: var(--color-text);
    line-height: 1.6;
  }
</style>
