---
// Website Examples Carousel Component
interface Props {
  lang?: "es" | "en";
}

const { lang = "es" } = Astro.props;

// Website examples with descriptions for Barcelona businesses
const websiteExamples = [
  {
    id: 1,
    title: lang === "es" ? "Restaurante Premium Barcelona" : "Premium Restaurant Barcelona",
    category: lang === "es" ? "Restauraci√≥n" : "Restaurant",
    description: lang === "es" ? "P√°gina web elegante con reservas online" : "Elegant website with online reservations",
    bgGradient: "from-orange-600 to-red-700",
    icon: "üçΩÔ∏è"
  },
  {
    id: 2,
    title: lang === "es" ? "Despacho Jur√≠dico Eixample" : "Law Firm Eixample",
    category: lang === "es" ? "Servicios Legales" : "Legal Services", 
    description: lang === "es" ? "Sitio corporativo con formularios de consulta" : "Corporate site with consultation forms",
    bgGradient: "from-blue-800 to-indigo-900",
    icon: "‚öñÔ∏è"
  },
  {
    id: 3,
    title: lang === "es" ? "Boutique Moda Gr√†cia" : "Fashion Boutique Gr√†cia",
    category: lang === "es" ? "E-commerce" : "E-commerce",
    description: lang === "es" ? "Tienda online con carrito y pagos" : "Online store with cart and payments",
    bgGradient: "from-pink-600 to-purple-700",
    icon: "üëó"
  },
  {
    id: 4,
    title: lang === "es" ? "Consultor√≠a Empresarial" : "Business Consulting",
    category: lang === "es" ? "Consultor√≠a" : "Consulting",
    description: lang === "es" ? "Landing page optimizada para leads" : "Lead-optimized landing page",
    bgGradient: "from-green-600 to-teal-700",
    icon: "üìä"
  },
  {
    id: 5,
    title: lang === "es" ? "Cl√≠nica Dental Barcelona" : "Dental Clinic Barcelona",
    category: lang === "es" ? "Salud" : "Healthcare",
    description: lang === "es" ? "Web m√©dica con sistema de citas" : "Medical website with appointment system",
    bgGradient: "from-cyan-600 to-blue-700",
    icon: "ü¶∑"
  },
  {
    id: 6,
    title: lang === "es" ? "Inmobiliaria Born" : "Real Estate Born",
    category: lang === "es" ? "Inmobiliaria" : "Real Estate",
    description: lang === "es" ? "Portal inmobiliario con b√∫squeda avanzada" : "Real estate portal with advanced search",
    bgGradient: "from-yellow-600 to-orange-700",
    icon: "üè¢"
  }
];
---

<div class="relative w-full h-full overflow-hidden rounded-lg bg-slate-800">
  <!-- Carousel Container -->
  <div id="website-carousel" class="flex transition-transform duration-500 ease-in-out h-full">
    {websiteExamples.map((site, index) => (
      <div 
        class="min-w-full h-full relative flex items-center justify-center bg-gradient-to-br {site.bgGradient} opacity-90"
        data-slide={index}
      >
        <!-- Website Mockup -->
        <div class="relative w-full max-w-4xl mx-auto px-8">
          <!-- Browser Frame -->
          <div class="bg-slate-900 rounded-t-lg p-3 shadow-2xl">
            <div class="flex items-center space-x-2">
              <div class="w-3 h-3 bg-red-500 rounded-full"></div>
              <div class="w-3 h-3 bg-yellow-500 rounded-full"></div>
              <div class="w-3 h-3 bg-green-500 rounded-full"></div>
              <div class="flex-1 mx-4">
                <div class="bg-slate-700 rounded px-3 py-1 text-xs text-slate-400">
                  {site.title.toLowerCase().replace(/\s+/g, '')}.com
                </div>
              </div>
            </div>
          </div>
          
          <!-- Website Content -->
          <div class="bg-white rounded-b-lg p-8 shadow-2xl min-h-[300px] relative overflow-hidden" role="img" aria-label={`${lang === "es" ? "Dise√±o web ejemplo para" : "Website design example for"} ${site.title}`}>
            <!-- Header -->
            <div class="flex items-center justify-between mb-6">
              <div class="flex items-center space-x-3">
                <div class="w-8 h-8 bg-gradient-to-br {site.bgGradient} rounded-lg flex items-center justify-center text-white text-sm" role="img" aria-label={site.category}>
                  {site.icon}
                </div>
                <div class="text-slate-800 font-bold text-lg">{site.title}</div>
              </div>
              <div class="hidden md:flex space-x-6 text-sm text-slate-600">
                <div>{lang === "es" ? "Inicio" : "Home"}</div>
                <div>{lang === "es" ? "Servicios" : "Services"}</div>
                <div>{lang === "es" ? "Contacto" : "Contact"}</div>
              </div>
            </div>
            
            <!-- Hero Section -->
            <div class="text-center py-8">
              <h2 class="text-3xl font-bold text-slate-800 mb-4">
                {lang === "es" ? "Bienvenido a" : "Welcome to"} {site.title}
              </h2>
              <p class="text-slate-600 mb-6 max-w-2xl mx-auto">
                {site.description}
              </p>
              <div class="inline-flex items-center px-6 py-3 bg-gradient-to-r {site.bgGradient} text-white rounded-lg font-semibold text-sm">
                {lang === "es" ? "Comenzar" : "Get Started"}
              </div>
            </div>
            
            <!-- Content Grid -->
            <div class="grid grid-cols-3 gap-4 mt-8">
              <div class="bg-slate-50 rounded-lg p-4 h-20"></div>
              <div class="bg-slate-50 rounded-lg p-4 h-20"></div>
              <div class="bg-slate-50 rounded-lg p-4 h-20"></div>
            </div>
            
            <!-- Category Badge -->
            <div class="absolute top-4 right-4 bg-gradient-to-r {site.bgGradient} text-white px-3 py-1 rounded-full text-xs font-semibold">
              {site.category}
            </div>
          </div>
        </div>
        
        <!-- Slide Info -->
        <div class="absolute bottom-4 left-4 text-white">
          <div class="bg-black/30 backdrop-blur-sm rounded-lg p-3">
            <div class="text-sm opacity-75">{lang === "es" ? "Proyecto" : "Project"} {index + 1}</div>
            <div class="font-semibold">{site.category}</div>
          </div>
        </div>
      </div>
    ))}
  </div>
  
  <!-- Navigation Dots -->
  <div class="absolute bottom-4 right-4 flex space-x-2">
    {websiteExamples.map((_, index) => (
      <button 
        class="w-3 h-3 rounded-full bg-white/30 hover:bg-white/60 transition-colors carousel-dot"
        data-slide={index}
        aria-label={`${lang === "es" ? "Ir al slide" : "Go to slide"} ${index + 1}`}
      ></button>
    ))}
  </div>
  
  <!-- Progress Bar -->
  <div class="absolute bottom-0 left-0 w-full h-1 bg-black/20">
    <div id="carousel-progress" class="h-full bg-gradient-to-r from-blue-400 to-purple-500 transition-all duration-500 ease-linear w-0"></div>
  </div>
</div>

<script>
  class WebsiteCarousel {
    constructor() {
      this.carousel = document.getElementById('website-carousel');
      this.dots = document.querySelectorAll('.carousel-dot');
      this.progress = document.getElementById('carousel-progress');
      this.currentSlide = 0;
      this.totalSlides = this.dots.length;
      this.isPlaying = true;
      this.intervalId = null;
      this.slideInterval = 4000; // 4 seconds per slide
      
      this.init();
    }
    
    init() {
      // Set up dot click listeners
      this.dots.forEach((dot, index) => {
        dot.addEventListener('click', () => this.goToSlide(index));
      });
      
      // Start auto-play
      this.startAutoPlay();
      
      // Pause on hover
      this.carousel.parentElement.addEventListener('mouseenter', () => this.pauseAutoPlay());
      this.carousel.parentElement.addEventListener('mouseleave', () => this.startAutoPlay());
      
      // Initial state
      this.updateDots();
      this.updateProgress();
    }
    
    goToSlide(index) {
      this.currentSlide = index;
      const translateX = -index * 100;
      this.carousel.style.transform = `translateX(${translateX}%)`;
      this.updateDots();
      this.resetProgress();
    }
    
    nextSlide() {
      this.currentSlide = (this.currentSlide + 1) % this.totalSlides;
      this.goToSlide(this.currentSlide);
    }
    
    updateDots() {
      this.dots.forEach((dot, index) => {
        if (index === this.currentSlide) {
          dot.classList.add('bg-white/80');
          dot.classList.remove('bg-white/30');
        } else {
          dot.classList.add('bg-white/30');
          dot.classList.remove('bg-white/80');
        }
      });
    }
    
    updateProgress() {
      let startTime = Date.now();
      const animate = () => {
        if (!this.isPlaying) return;
        
        const elapsed = Date.now() - startTime;
        const progress = Math.min((elapsed / this.slideInterval) * 100, 100);
        this.progress.style.width = `${progress}%`;
        
        if (progress < 100) {
          requestAnimationFrame(animate);
        }
      };
      
      requestAnimationFrame(animate);
    }
    
    resetProgress() {
      this.progress.style.width = '0%';
      this.updateProgress();
    }
    
    startAutoPlay() {
      if (this.intervalId) clearInterval(this.intervalId);
      this.isPlaying = true;
      this.intervalId = setInterval(() => {
        this.nextSlide();
      }, this.slideInterval);
      this.updateProgress();
    }
    
    pauseAutoPlay() {
      this.isPlaying = false;
      if (this.intervalId) {
        clearInterval(this.intervalId);
        this.intervalId = null;
      }
    }
  }
  
  // Initialize carousel when DOM is loaded
  document.addEventListener('DOMContentLoaded', () => {
    new WebsiteCarousel();
  });
  
  // Reinitialize on navigation (for SPA behavior)
  document.addEventListener('astro:page-load', () => {
    new WebsiteCarousel();
  });
</script>

<style>
  /* Ensure smooth transitions */
  #website-carousel {
    will-change: transform;
  }
  
  /* Hover effects for dots */
  .carousel-dot {
    transition: all 0.3s ease;
    cursor: pointer;
  }
  
  .carousel-dot:hover {
    transform: scale(1.2);
  }
  
  /* Progress bar animation */
  #carousel-progress {
    will-change: width;
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .carousel-dot {
      width: 8px;
      height: 8px;
    }
  }
</style>