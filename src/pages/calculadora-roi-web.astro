---
import Layout from "../layouts/Layout.astro";

const locale = "es";
const title = "Calculadora ROI Web Barcelona 2024 - ¿Cuánto Pierdes Sin Web?";
const description = "💰 Calcula cuánto dinero pierde tu empresa Barcelona sin web profesional. Calculadora ROI gratuita con resultados instantáneos y reporte personalizado.";
---

<Layout 
  title={title}
  description={description}
  lang={locale}
  keywords={[
    "calculadora ROI web Barcelona",
    "retorno inversión página web",
    "cuánto cuesta no tener web",
    "ROI desarrollo web Barcelona", 
    "inversión página web empresas",
    "beneficios web profesional Barcelona"
  ]}
>
  <main class="min-h-screen bg-slate-900 text-white">
    <!-- Hero Section -->
    <section class="relative py-20 overflow-hidden">
      <div class="absolute inset-0 bg-gradient-to-br from-green-900/20 to-blue-900/20"></div>
      <div class="container mx-auto px-4 relative z-10">
        <div class="max-w-4xl mx-auto text-center">
          <h1 class="text-4xl md:text-6xl font-bold mb-6 bg-gradient-to-r from-green-400 to-blue-400 bg-clip-text text-transparent">
            Calculadora ROI Web
          </h1>
          <h2 class="text-xl md:text-2xl mb-8 text-slate-300">
            ¿Cuánto dinero pierdes cada mes sin una web profesional?
          </h2>
          <p class="text-lg mb-8 text-slate-400 max-w-2xl mx-auto">
            Descubre el impacto real que tiene no tener una página web profesional en los ingresos de tu negocio Barcelona.
          </p>
        </div>
      </div>
    </section>

    <!-- Calculator Section -->
    <section class="py-16">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          
          <!-- Calculator Form -->
          <div class="bg-slate-800 p-8 rounded-xl border border-slate-700 mb-8">
            <h3 class="text-2xl font-bold mb-6 text-center">Calcula tu ROI Potencial</h3>
            
            <form id="roi-calculator" class="space-y-6">
              <div class="grid md:grid-cols-2 gap-6">
                <div>
                  <label for="business-type" class="block text-sm font-medium mb-2">Tipo de negocio *</label>
                  <select 
                    id="business-type" 
                    name="businessType"
                    required
                    class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  >
                    <option value="">Selecciona tu sector</option>
                    <option value="restaurante" data-multiplier="1.5">Restaurante/Café</option>
                    <option value="retail" data-multiplier="2.0">Tienda/Comercio</option>
                    <option value="servicios" data-multiplier="3.0">Servicios profesionales</option>
                    <option value="salud" data-multiplier="2.5">Salud y bienestar</option>
                    <option value="inmobiliaria" data-multiplier="4.0">Inmobiliaria</option>
                    <option value="consultoria" data-multiplier="3.5">Consultoría</option>
                  </select>
                </div>

                <div>
                  <label for="monthly-revenue" class="block text-sm font-medium mb-2">Ingresos mensuales aproximados *</label>
                  <select 
                    id="monthly-revenue" 
                    name="monthlyRevenue"
                    required
                    class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  >
                    <option value="">Selecciona rango</option>
                    <option value="5000">€0 - €5,000</option>
                    <option value="15000">€5,000 - €15,000</option>
                    <option value="30000">€15,000 - €30,000</option>
                    <option value="50000">€30,000 - €50,000</option>
                    <option value="75000">€50,000 - €75,000</option>
                    <option value="100000">€75,000+</option>
                  </select>
                </div>

                <div>
                  <label for="current-web" class="block text-sm font-medium mb-2">¿Tienes página web actual?</label>
                  <select 
                    id="current-web" 
                    name="currentWeb"
                    class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  >
                    <option value="none">No tengo página web</option>
                    <option value="basic">Tengo una básica/antigua</option>
                    <option value="decent">Tengo una decente</option>
                  </select>
                </div>

                <div>
                  <label for="competitor-online" class="block text-sm font-medium mb-2">¿Tus competidores están online?</label>
                  <select 
                    id="competitor-online" 
                    name="competitorOnline"
                    class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  >
                    <option value="few">Pocos tienen web</option>
                    <option value="some">Algunos tienen web</option>
                    <option value="most">La mayoría tiene web</option>
                    <option value="all">Todos tienen web profesional</option>
                  </select>
                </div>

                <div>
                  <label for="location-importance" class="block text-sm font-medium mb-2">¿Qué tan importante es tu ubicación física?</label>
                  <select 
                    id="location-importance" 
                    name="locationImportance"
                    class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                  >
                    <option value="not">No es importante (100% online)</option>
                    <option value="some">Algo importante</option>
                    <option value="very">Muy importante</option>
                    <option value="critical">Crítica (negocio local)</option>
                  </select>
                </div>

                <div>
                  <label for="email" class="block text-sm font-medium mb-2">Email para recibir reporte detallado *</label>
                  <input 
                    type="email" 
                    id="email" 
                    name="email"
                    required
                    class="w-full px-4 py-3 bg-slate-700 border border-slate-600 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent"
                    placeholder="tu@empresa.com"
                  />
                </div>
              </div>

              <button 
                type="submit"
                class="w-full bg-gradient-to-r from-green-500 to-blue-600 hover:from-green-600 hover:to-blue-700 text-white font-semibold py-4 px-6 rounded-lg transition-all duration-200 transform hover:scale-105"
              >
                💰 Calcular Mi ROI Potencial
              </button>
            </form>
          </div>

          <!-- Results Section -->
          <div id="results" class="hidden bg-gradient-to-r from-green-900/30 to-blue-900/30 border border-green-500/30 p-8 rounded-xl">
            <h3 class="text-3xl font-bold mb-6 text-center text-green-400">Tu Potencial de Crecimiento</h3>
            
            <div class="grid md:grid-cols-3 gap-6 mb-8">
              <div class="text-center">
                <div class="text-4xl font-bold text-green-400 mb-2" id="monthly-loss">€0</div>
                <div class="text-slate-400">Pérdida mensual estimada</div>
              </div>
              <div class="text-center">
                <div class="text-4xl font-bold text-blue-400 mb-2" id="annual-opportunity">€0</div>
                <div class="text-slate-400">Oportunidad anual</div>
              </div>
              <div class="text-center">
                <div class="text-4xl font-bold text-purple-400 mb-2" id="roi-percentage">0%</div>
                <div class="text-slate-400">ROI esperado</div>
              </div>
            </div>

            <div class="bg-slate-800 p-6 rounded-lg mb-6">
              <h4 class="text-xl font-bold mb-4">📈 Proyección de Beneficios con Web Profesional</h4>
              <div id="projection-details" class="space-y-2 text-slate-300">
                <!-- Dynamic content will be inserted here -->
              </div>
            </div>

            <div class="text-center">
              <p class="text-slate-400 mb-4">¿Quieres un análisis más detallado personalizado para tu negocio?</p>
              <a href="/auditoria-web-gratuita" class="inline-block bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition-colors">
                Solicitar Auditoría Gratuita
              </a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Features Section -->
    <section class="py-16 bg-slate-800/50">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h3 class="text-3xl font-bold text-center mb-12">Por qué las empresas Barcelona necesitan una web profesional</h3>
          
          <div class="grid md:grid-cols-2 gap-8">
            <div class="space-y-6">
              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <span class="text-white font-bold">📱</span>
                </div>
                <div>
                  <h4 class="font-semibold text-lg mb-2">El 87% busca online antes de comprar</h4>
                  <p class="text-slate-400">Incluso para negocios locales Barcelona, los clientes investigan online antes de visitar o comprar.</p>
                </div>
              </div>

              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <span class="text-white font-bold">⏰</span>
                </div>
                <div>
                  <h4 class="font-semibold text-lg mb-2">Disponible 24/7 para captar clientes</h4>
                  <p class="text-slate-400">Tu web trabaja mientras duermes, captando leads y mostrando tus servicios a potenciales clientes.</p>
                </div>
              </div>

              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <span class="text-white font-bold">🎯</span>
                </div>
                <div>
                  <h4 class="font-semibold text-lg mb-2">Competir con empresas más grandes</h4>
                  <p class="text-slate-400">Una web profesional te pone al mismo nivel que competidores más grandes en Barcelona.</p>
                </div>
              </div>
            </div>

            <div class="space-y-6">
              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <span class="text-white font-bold">💼</span>
                </div>
                <div>
                  <h4 class="font-semibold text-lg mb-2">Credibilidad y profesionalidad</h4>
                  <p class="text-slate-400">Los clientes confían más en empresas con presencia web profesional y actualizada.</p>
                </div>
              </div>

              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <span class="text-white font-bold">📊</span>
                </div>
                <div>
                  <h4 class="font-semibold text-lg mb-2">Datos y métricas de clientes</h4>
                  <p class="text-slate-400">Conoce a tus clientes, de dónde vienen y qué les interesa más para mejorar tu negocio.</p>
                </div>
              </div>

              <div class="flex items-start space-x-4">
                <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center flex-shrink-0 mt-1">
                  <span class="text-white font-bold">🚀</span>
                </div>
                <div>
                  <h4 class="font-semibold text-lg mb-2">Escalabilidad y crecimiento</h4>
                  <p class="text-slate-400">Tu web crece contigo, añadiendo funcionalidades según las necesidades de tu negocio.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>
</Layout>

<script>
  document.getElementById('roi-calculator')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const formData = new FormData(e.target as HTMLFormElement);
    const data = Object.fromEntries(formData);
    
    // Calculate ROI
    const monthlyRevenue = parseInt(data.monthlyRevenue as string) || 0;
    const businessType = data.businessType as string;
    const currentWeb = data.currentWeb as string;
    const competitorOnline = data.competitorOnline as string;
    const locationImportance = data.locationImportance as string;
    
    // ROI calculation logic
    let baseIncrease = 0.15; // 15% base increase
    
    // Business type multiplier
    const businessMultipliers: Record<string, number> = {
      'restaurante': 1.2,
      'retail': 1.5,
      'servicios': 2.0,
      'salud': 1.8,
      'inmobiliaria': 2.5,
      'consultoria': 2.2
    };
    
    // Current web situation
    const webMultipliers: Record<string, number> = {
      'none': 1.5,
      'basic': 1.2,
      'decent': 1.0
    };
    
    // Competition factor
    const competitionMultipliers: Record<string, number> = {
      'few': 2.0,
      'some': 1.5,
      'most': 1.2,
      'all': 1.0
    };
    
    // Location importance
    const locationMultipliers: Record<string, number> = {
      'not': 0.8,
      'some': 1.0,
      'very': 1.3,
      'critical': 1.5
    };
    
    const totalMultiplier = 
      (businessMultipliers[businessType] || 1) *
      (webMultipliers[currentWeb] || 1) *
      (competitionMultipliers[competitorOnline] || 1) *
      (locationMultipliers[locationImportance] || 1);
    
    const finalIncrease = Math.min(baseIncrease * totalMultiplier, 0.8); // Cap at 80%
    const monthlyIncrease = monthlyRevenue * finalIncrease;
    const annualIncrease = monthlyIncrease * 12;
    const investmentCost = 1500; // Average web cost
    const roiPercentage = Math.round((annualIncrease / investmentCost) * 100);
    
    // Display results
    document.getElementById('monthly-loss')!.textContent = `€${monthlyIncrease.toLocaleString()}`;
    document.getElementById('annual-opportunity')!.textContent = `€${annualIncrease.toLocaleString()}`;
    document.getElementById('roi-percentage')!.textContent = `${roiPercentage}%`;
    
    // Detailed projection
    const projectionDetails = document.getElementById('projection-details')!;
    projectionDetails.innerHTML = `
      <div>✓ Aumento estimado de ingresos: ${Math.round(finalIncrease * 100)}%</div>
      <div>✓ Nuevos clientes potenciales por mes: ${Math.round(monthlyIncrease / 100)}</div>
      <div>✓ Inversión inicial recomendada: €${investmentCost.toLocaleString()}</div>
      <div>✓ Tiempo de recuperación: ${Math.round(investmentCost / monthlyIncrease)} meses</div>
      <div>✓ Beneficio neto primer año: €${(annualIncrease - investmentCost).toLocaleString()}</div>
    `;
    
    document.getElementById('results')!.classList.remove('hidden');
    
    // Send data to API
    try {
      const apiData = {
        ...data,
        type: 'Calculadora ROI',
        source: 'roi-calculator',
        locale: 'es',
        calculatedROI: {
          monthlyIncrease,
          annualIncrease,
          roiPercentage,
          finalIncrease
        }
      };
      
      await fetch('/api/contact', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(apiData),
      });
    } catch (error) {
      console.error('Error sending data:', error);
    }
    
    // Scroll to results
    document.getElementById('results')?.scrollIntoView({ behavior: 'smooth' });
  });
</script>
</Layout>