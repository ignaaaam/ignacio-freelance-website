---
import '../styles/global.css';

interface Props {
	title: string;
	description?: string;
	lang?: 'es' | 'en';
}

const { 
	title, 
	description = "Diseño y desarrollo webs modernas, rápidas y optimizadas para destacar a nivel global.",
	lang = 'es'
} = Astro.props;
---

<!DOCTYPE html>
<html lang={lang} data-theme="dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />
		<title>{title}</title>
		<meta name="description" content={description} />
		<meta name="theme-color" content="#0F172A" />
		<link rel="alternate" hreflang="es" href="https://ignacioamatweb.com" />
		<link rel="alternate" hreflang="en" href="https://ignacioamatweb.com/en" />
	</head>
	<body>
		<slot />
	</body>
</html>

<style>
	/* Theme transitions */
	:root {
		transition: all 0.3s ease;
	}

	/* Light theme overrides */
	[data-theme="light"] {
		--color-primary: #ffffff;
		--color-secondary: #f1f5f9;
		--color-text: #0f172a;
		--color-text-muted: #64748b;
		--color-border: #e2e8f0;
		--color-card-bg: rgba(241, 245, 249, 0.5);
	}

	/* Glow effects */
	.glow {
		position: absolute;
		border-radius: 50%;
		filter: blur(100px);
		opacity: 0.15;
		pointer-events: none;
	}

	.glow-1 {
		top: 0;
		left: 15%;
		width: 300px;
		height: 300px;
		background: var(--color-accent);
	}

	.glow-2 {
		top: 20%;
		right: 10%;
		width: 400px;
		height: 400px;
		background: #3b82f6;
	}

	[data-theme="light"] .glow {
		opacity: 0.1;
	}
</style>

<script>
	// Theme toggle functionality
	const themeToggle = document.getElementById('theme-toggle');
	const prefersDark = window.matchMedia('(prefers-color-scheme: dark)');
	
	function setTheme(isDark: boolean) {
		document.documentElement.setAttribute('data-theme', isDark ? 'dark' : 'light');
		localStorage.setItem('theme', isDark ? 'dark' : 'light');
	}

	// Initialize theme
	const savedTheme = localStorage.getItem('theme');
	if (savedTheme) {
		setTheme(savedTheme === 'dark');
	} else {
		setTheme(prefersDark.matches);
	}

	// Listen for theme toggle clicks
	themeToggle?.addEventListener('click', () => {
		const isDark = document.documentElement.getAttribute('data-theme') === 'dark';
		setTheme(!isDark);
	});

	// Listen for system theme changes
	prefersDark.addEventListener('change', (e) => {
		if (!localStorage.getItem('theme')) {
			setTheme(e.matches);
		}
	});

	// Initialize ScrollReveal
	document.addEventListener('DOMContentLoaded', () => {
		const script = document.createElement('script');
		script.src = 'https://unpkg.com/scrollreveal@4.0.9/dist/scrollreveal.min.js';
		script.onload = () => {
			// @ts-ignore
			const sr = window.ScrollReveal({
				origin: 'bottom',
				distance: '60px',
				duration: 1000,
				delay: 200,
				reset: true,
				easing: 'cubic-bezier(0.5, 0, 0, 1)',
			});

			// Reveal elements with data-sr attribute
			document.querySelectorAll('[data-sr]').forEach((el) => {
				sr.reveal(el, {
					delay: el.getAttribute('data-sr-delay') ? parseInt(el.getAttribute('data-sr-delay')!) : 200,
					origin: el.getAttribute('data-sr-origin') || 'bottom',
					distance: el.getAttribute('data-sr-distance') || '60px',
					duration: el.getAttribute('data-sr-duration') ? parseInt(el.getAttribute('data-sr-duration')!) : 1000,
				});
			});
		};
		document.head.appendChild(script);
	});
</script>
